(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{2653:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a(13),c=a(15),o=a(14),s=a(16),l=a(0),i=a.n(l),u=a(59),m=a(4),p=a(109),d=a(20),f=a(290),C=a(1),h=a(362),E=a(53),b=a.n(E),g="[CONTACTS APP] GET USER DATA";function v(){var e=b.a.get("/api/contacts-app/user");return function(t){return e.then(function(e){return t({type:g,payload:e.data})})}}var T="[CONTACTS APP] GET CONTACTS",O="[CONTACTS APP] SET SEARCH TEXT",N="[CONTACTS APP] TOGGLE IN SELECTED CONTACTS",A="[CONTACTS APP] SELECT ALL CONTACTS",y="[CONTACTS APP] DESELECT ALL CONTACTS",S="[CONTACTS APP] OPEN NEW CONTACT DIALOG",P="[CONTACTS APP] CLOSE NEW CONTACT DIALOG",j="[CONTACTS APP] OPEN EDIT CONTACT DIALOG",D="[CONTACTS APP] CLOSE EDIT CONTACT DIALOG",w="[CONTACTS APP] ADD CONTACT",x="[CONTACTS APP] UPDATE CONTACT",L="[CONTACTS APP] REMOVE CONTACT",U="[CONTACTS APP] REMOVE CONTACTS",I="[CONTACTS APP] TOGGLE STARRED CONTACT",k="[CONTACTS APP] TOGGLE STARRED CONTACTS",G="[CONTACTS APP] SET CONTACTS STARRED ";function M(e){var t=b.a.get("/api/contacts-app/contacts",{params:e});return function(a){return t.then(function(t){return a({type:T,payload:t.data,routeParams:e})})}}function H(e){return{type:O,searchText:e.target.value}}function R(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/remove-contact",{contactId:e}).then(function(e){return Promise.all([t({type:L})]).then(function(){return t(M(n))})})}}var _=a(285),B=a(119),F=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={selectedContactsMenu:null},a.openDeleteConfirmationModal=function(e){var t=e._id,n=e.userName;return function(e){e.preventDefault(),e.stopPropagation(),(0,a.props.openConfirmationModal)({title:"Confirmation",content:"Are you sure you want to delete user '".concat(n,"'?"),handleConfirm:a.confirmDelete(t)})}},a.confirmDelete=function(e){return function(){var t=a.props,n=t.deleteUser,r=t.getUserList,c=t.closeConfirmationModal;n(e,function(){r(),c()})}},a.getFilteredArray=function(e,t){var a=Object.keys(e).map(function(t){return e[t]});return 0===t.length?a:m.A.filterArrayByString(a,t)},a.openSelectedContactMenu=function(e){a.setState({selectedContactsMenu:e.currentTarget})},a.closeSelectedContactsMenu=function(){a.setState({selectedContactsMenu:null})},a.handleStatusToggle=function(e,t){return function(n){n.preventDefault(),n.stopPropagation();var r=a.props,c=r.activateUser,o=r.deActivateUser,s=r.getUserList;"active"===t?o(e,s):c(e,s)}},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.users,n=t.contacts,r=t.user,c=t.searchText,o=t.selectedContactIds,s=t.openEditContactDialog,l=t.toggleStarredContact,u=t.setContactsUnstarred,p=t.setContactsStarred,d=this.getFilteredArray(n,c),f=this.state.selectedContactsMenu;return d||0!==d.length?i.a.createElement("div",{className:"user-list-table"},i.a.createElement(m.d,{animation:"transition.slideUpIn",delay:300},i.a.createElement(h.b,{className:"-striped -highlight border-0",getTrProps:function(e,t,a){return{className:"cursor-pointer",onClick:function(e,a){t&&s(t.original)}}},data:a,columns:[{Header:function(){return o.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(C.H,{"aria-owns":f?"selectedContactsMenu":null,"aria-haspopup":"true",onClick:e.openSelectedContactMenu},i.a.createElement(C.G,null,"more_horiz")),i.a.createElement(C.S,{id:"selectedContactsMenu",anchorEl:f,open:Boolean(f),onClose:e.closeSelectedContactsMenu},i.a.createElement(C.U,null,i.a.createElement(C.T,{onClick:e.openDeleteConfirmationModal},i.a.createElement(C.O,null,i.a.createElement(C.G,null,"delete")),i.a.createElement(C.Q,{inset:!0,primary:"Remove"})),i.a.createElement(C.T,{onClick:function(){p(o),e.closeSelectedContactsMenu()}},i.a.createElement(C.O,null,i.a.createElement(C.G,null,"star")),i.a.createElement(C.Q,{inset:!0,primary:"Starred"})),i.a.createElement(C.T,{onClick:function(){u(o),e.closeSelectedContactsMenu()}},i.a.createElement(C.O,null,i.a.createElement(C.G,null,"visibility")),i.a.createElement(C.Q,{inset:!0,primary:"Unstarred"})))))},accessor:"avatar",Cell:function(e){return i.a.createElement(C.b,{className:"mr-8",alt:e.original.name,src:e.value})},className:"justify-center",sortable:!1,width:80},{Header:"Full Name",accessor:"userName",filterable:!0,Cell:function(e){return i.a.createElement("span",{className:"capitalize"},e.original.userName)}},{Header:"Email",accessor:"email",filterable:!0,width:250},{Header:"Status",accessor:"status",width:80,Cell:function(e){return i.a.createElement("span",{className:"capitalize"},e.original.status)}},{Header:"Online",accessor:"online",width:80,Cell:function(e){return i.a.createElement("span",{className:"capitalize"},e.original.online?"Online":"Offline")}},{Header:"Phone",accessor:"phoneNumber",filterable:!0},{Header:"Created At",accessor:"createdAt",filterable:!0,Cell:function(e){return i.a.createElement("span",null,new Date(e.original.createdAt).toLocaleDateString())}},{Header:"",Cell:function(t){return i.a.createElement("div",{className:"flex items-center"},i.a.createElement(C.H,{onClick:e.handleStatusToggle(t.original._id,t.original.status)},"active"===t.original.status?i.a.createElement(C.G,null,"check_circle_outline"):i.a.createElement(C.G,null,"highlight_off")),i.a.createElement(C.H,{onClick:function(e){e.stopPropagation(),l(t.original.id)}},r.starred&&r.starred.includes(t.original.id)?i.a.createElement(C.G,null,"star"):i.a.createElement(C.G,null,"visibility")),i.a.createElement(C.H,{onClick:e.openDeleteConfirmationModal(t.original)},i.a.createElement(C.G,null,"delete")))}}],defaultPageSize:10,noDataText:"No contacts found"}))):i.a.createElement("div",{className:"flex items-center justify-center h-full"},i.a.createElement(C.vb,{color:"textSecondary",variant:"h5"},"There are no contacts!"))}}]),t}(l.Component),W=Object(p.g)(Object(d.b)(function(e){var t=e.contactsApp,a=e.appuser;return{isLoading:a.isLoading,users:a.users,contacts:t.contacts.entities,selectedContactIds:t.contacts.selectedContactIds,searchText:t.contacts.searchText,user:t.user}},{deleteUser:B.c,getUserList:B.d,activateUser:B.a,deActivateUser:B.b,openConfirmationModal:_.b,closeConfirmationModal:_.a,getContacts:M,getUserData:v,removeContact:R,removeContacts:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/remove-contacts",{contactIds:e}).then(function(e){return Promise.all([t({type:U}),t({type:y})]).then(function(){return t(M(n))})})}},selectAllContacts:function(){return{type:A}},setContactsStarred:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/set-contacts-starred",{contactIds:e}).then(function(e){return Promise.all([t({type:G}),t({type:y}),t(v())]).then(function(){return t(M(n))})})}},deSelectAllContacts:function(){return{type:y}},setContactsUnstarred:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/set-contacts-unstarred",{contactIds:e}).then(function(e){return Promise.all([t({type:G}),t({type:y}),t(v())]).then(function(){return t(M(n))})})}},toggleStarredContact:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/toggle-starred-contact",{contactId:e}).then(function(e){return Promise.all([t({type:I}),t(v())]).then(function(){return t(M(n))})})}},toggleStarredContacts:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/toggle-starred-contacts",{contactIds:e}).then(function(e){return Promise.all([t({type:k}),t({type:y}),t(v())]).then(function(){return t(M(n))})})}},openEditContactDialog:function(e){return{type:j,data:e}},toggleInSelectedContacts:function(e){return{type:N,contactId:e}}})(F)),q=a(19),z=function(e){function t(){return Object(n.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.pageLayout;return i.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},i.a.createElement("div",{className:"flex flex-shrink items-center sm:w-224"},i.a.createElement(C.F,{lgUp:!0},i.a.createElement(C.H,{onClick:function(t){return e().toggleLeftSidebar()},"aria-label":"open left sidebar"},i.a.createElement(C.G,null,"menu"))),i.a.createElement("div",{className:"flex items-center"},i.a.createElement(m.d,{animation:"transition.expandIn",delay:300},i.a.createElement(C.G,{className:"text-32 mr-12"},"account_box")),i.a.createElement(m.d,{animation:"transition.slideLeftIn",delay:300},i.a.createElement(C.vb,{variant:"h6",className:"hidden sm:flex"},"Users")))),i.a.createElement("div",{className:"flex flex-1 items-center justify-center pr-8 sm:px-12"}))}}]),t}(l.Component);var Q=Object(d.b)(function(e){var t=e.contactsApp,a=e.fuse;return{searchText:t.contacts.searchText,mainTheme:a.settings.mainTheme}},function(e){return Object(q.c)({setSearchText:H},e)})(z),V=a(6),J=a(9),X=a(801),K=a(379),Y={userName:Object(K.b)("Username must be a valid string").required("Username is required").min(3,"Username must be atleast of 3 characters"),email:Object(K.b)("Email Address must be a valid string").email("Email must be a valid email address e.g. yourname@yourbusiness.com").required("Email is required")},Z={id:"",name:"",lastName:"",avatar:"assets/images/avatars/profile.jpg",nickname:"",company:"",jobTitle:"",email:"",phone:"",address:"",birthday:"",notes:""},$=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state=Object(V.a)({},Z),a.handleUpdate=function(e){var t=a.props.updateUser,n=a.state,r=n._id,c=n.avatar;t(Object(V.a)({avatar:c,userId:r},e),a.refetch)},a.refetch=function(){(0,a.props.getUserList)(),a.closeComposeDialog()},a.closeComposeDialog=function(){"edit"===a.props.contactDialog.type?a.props.closeEditContactDialog():a.props.closeNewContactDialog()},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){!e.contactDialog.props.open&&this.props.contactDialog.props.open&&("edit"===this.props.contactDialog.type&&this.props.contactDialog.data&&!J.a.isEqual(this.props.contactDialog.data,t)&&this.setState(Object(V.a)({},this.props.contactDialog.data)),"new"!==this.props.contactDialog.type||J.a.isEqual(Z,t)||this.setState(Object(V.a)({},Z)))}},{key:"canBeSubmitted",value:function(){var e=this.state,t=e.userName,a=e.email,n=e.phoneNumber;return!t||(t&&t.length)<3||!a||!n}},{key:"render",value:function(){var e=this,t=this.props,a=t.contactDialog,n=t.addContact,r=this.state,c=r.userName,o=r.email,s=r.phoneNumber;return i.a.createElement(C.l,Object.assign({classes:{paper:"m-24"}},a.props,{onClose:this.closeComposeDialog,fullWidth:!0,maxWidth:"xs"}),i.a.createElement(X.a,{initialValues:{email:o,userName:c,phoneNumber:s},onSubmit:this.handleUpdate,validationSchema:Object(K.a)().shape(Y)},function(t){var r=t.handleSubmit,l=t.handleChange,u=t.handleBlur,m=t.values,p=t.errors;t.touched;return i.a.createElement(i.a.Fragment,null,i.a.createElement(C.a,{position:"static",elevation:1},i.a.createElement(C.tb,{className:"flex w-full"},i.a.createElement(C.vb,{variant:"subtitle1",color:"inherit"},"new"===a.type?"New Contact":"Edit Contact")),i.a.createElement("div",{className:"flex flex-col items-center justify-center pb-24"},i.a.createElement(C.b,{className:"w-96 h-96",alt:"contact avatar",src:e.state.avatar}),"edit"===a.type&&i.a.createElement(C.vb,{variant:"h6",color:"inherit",className:"pt-8"},c))),i.a.createElement(C.n,{classes:{root:"p-24"}},i.a.createElement("div",{className:"flex"},i.a.createElement("div",{className:"min-w-48 pt-20"},i.a.createElement(C.G,{color:"action"},"account_circle")),i.a.createElement(C.sb,{className:"mb-24",label:"Name",autoFocus:!0,id:"userName",name:"userName",value:m.userName,onChange:l,onBlur:u,variant:"outlined",required:!0,fullWidth:!0})),i.a.createElement("div",{className:"flex"},i.a.createElement("div",{className:"min-w-48 pt-20"}),i.a.createElement("div",{className:"mb-24"},p&&p.userName&&void 0!==p?i.a.createElement("span",null,p.userName):null)),i.a.createElement("div",{className:"flex"},i.a.createElement("div",{className:"min-w-48 pt-20"},i.a.createElement(C.G,{color:"action"},"phone")),i.a.createElement(C.sb,{className:"mb-24",label:"Phone",id:"phoneNumber",name:"phoneNumber",value:m.phoneNumber,onChange:l,variant:"outlined",fullWidth:!0})),p&&p.phoneNumber&&void 0!==p?i.a.createElement("span",null,p.phoneNumber):null,i.a.createElement("div",{className:"flex"},i.a.createElement("div",{className:"min-w-48 pt-20"},i.a.createElement(C.G,{color:"action"},"email")),i.a.createElement(C.sb,{className:"mb-24",label:"Email Address",id:"email",name:"email",value:m.email,onChange:l,variant:"outlined",fullWidth:!0})),p&&p.email&&void 0!==p?i.a.createElement("span",null,p.email):null),"new"===a.type?i.a.createElement(C.m,{className:"justify-between pl-16"},i.a.createElement(C.c,{variant:"contained",color:"primary",onClick:function(){n(e.state),e.closeComposeDialog()},disabled:!c||c&&c.length<3||!o||!s},"Add")):i.a.createElement(C.m,{className:"justify-between pl-16"},i.a.createElement(C.c,{variant:"contained",color:"primary",onClick:r,disabled:e.canBeSubmitted()},"Save")))}))}}]),t}(l.Component),ee=Object(d.b)(function(e){return{contactDialog:e.contactsApp.contacts.contactDialog}},{updateUser:B.e,getUserList:B.d,addContact:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/add-contact",{newContact:e}).then(function(e){return Promise.all([t({type:w})]).then(function(){return t(M(n))})})}},updateContact:function(e){return function(t,a){var n=a().contactsApp.contacts.routeParams;return b.a.post("/api/contacts-app/update-contact",{contact:e}).then(function(e){return Promise.all([t({type:x})]).then(function(){return t(M(n))})})}},removeContact:R,closeNewContactDialog:function(){return{type:P}},closeEditContactDialog:function(){return{type:D}}})($),te=a(18),ae={entities:[],searchText:"",selectedContactIds:[],routeParams:{},contactDialog:{type:"new",props:{open:!1},data:null}},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return Object(V.a)({},e,{entities:J.a.keyBy(t.payload,"id"),routeParams:t.routeParams});case O:return Object(V.a)({},e,{searchText:t.searchText});case N:var a=t.contactId,n=Object(te.a)(e.selectedContactIds);return n=void 0!==n.find(function(e){return e===a})?n.filter(function(e){return e!==a}):[].concat(Object(te.a)(n),[a]),Object(V.a)({},e,{selectedContactIds:n});case A:var r=Object.keys(e.entities).map(function(t){return e.entities[t]}).map(function(e){return e.id});return Object(V.a)({},e,{selectedContactIds:r});case y:return Object(V.a)({},e,{selectedContactIds:[]});case S:return Object(V.a)({},e,{contactDialog:{type:"new",props:{open:!0},data:null}});case P:return Object(V.a)({},e,{contactDialog:{type:"new",props:{open:!1},data:null}});case j:return Object(V.a)({},e,{contactDialog:{type:"edit",props:{open:!0},data:t.data}});case D:return Object(V.a)({},e,{contactDialog:{type:"edit",props:{open:!1},data:null}});default:return e}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return t.payload;default:return e}},ce=Object(q.d)({contacts:ne,user:re}),oe=function(e){function t(){return Object(n.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.getUserList(1)}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(m.s,{classes:{contentCardWrapper:"p-16 sm:p-24 pb-80",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:i.a.createElement(Q,{pageLayout:function(){return e.pageLayout}}),content:i.a.createElement(W,null),sidebarInner:!0,onRef:function(t){e.pageLayout=t},innerScroll:!0}),i.a.createElement(ee,null))}}]),t}(l.Component);t.default=Object(f.a)("contactsApp",ce)(Object(u.withStyles)(function(){return{addButton:{position:"absolute",right:12,bottom:12,zIndex:99}}},{withTheme:!0})(Object(p.g)(Object(d.b)(function(e){var t=e.appuser;return{isLoading:t.isLoading,users:t.users}},{getUserList:B.d})(oe))))}}]);